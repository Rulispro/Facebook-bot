name: Facebook Bot Scheduler

on:
  schedule:
    # Jalankan bot setiap jam untuk mengecek IndexedDB
    - cron: "0 * * * *"
  workflow_dispatch:  # Bisa dijalankan manual dari GitHub

jobs:
  check-and-run-bot:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ”¹ Checkout repository
        uses: actions/checkout@v3

      - name: ðŸ”¹ Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ðŸ”¹ Install dependencies
        run: npm install

      - name: ðŸ”¹ Ambil Jam Terpilih dari IndexedDB
        id: get_hours
        run: node get_hours.js  # Script untuk ambil jam posting

      - name: ðŸ”¹ Jalankan Bot Jika Jam Sesuai
        if: contains(steps.get_hours.outputs.currentHour, 'true')  # Hanya jalan jika jam terpilih
        run: node index.js
